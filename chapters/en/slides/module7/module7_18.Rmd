---
params:
  dynamictitle: "module7_05"
title: "`r params$dynamictitle`"
output: 
  md_document:
    variant: gfm
---


```{r setup, include=FALSE}
## DO NOT FORGET TO CHANGE THIS ACCORDINGLY 
library(rmarkdown)
# MAke sure you are updating your title 
knitr::opts_chunk$set(echo = TRUE,
                      base.dir = ".", 
                      base.url = "/",
                      fig.path = paste("../../static/module7/", params$dynamictitle,"/", sep = ""))

knitr_opts <- knitr_options( opts_knit = NULL,
                             opts_chunk = NULL,
                             knit_hooks = NULL,
                             opts_hooks = NULL,
                             opts_template = NULL)
md_document_custom <- md_document(variant = "gfm")
output_format(knitr = knitr_opts,
              pandoc = NULL,
              base_format = md_document_custom)
library(reticulate)

```


```{python include=FALSE}
import pandas as pd
import numpy as np
pd.set_option('display.width', 350)

np.set_printoptions(linewidth=400)

pd.set_option('display.max_columns', 50)
pd.set_option('display.max_rows', 15)
cereal = pd.read_csv('cereal.csv')
```


type: slides


# The Python debugger

Notes: <br>

---

<br>
<center><img src='/module7/m7_s18_01.png'  width = "90%" alt="404 image" /></center>

Notes: 

We are going to talk about the Python Debugger.

To do so we are going to examine a piece of code that has a bug in it and we're going to try to hunt down that bug with the debugger. 

That piece of code is a function called random walker. This function stimulates a random walk in two dimensions - so you can walk in any of four directions up, down, left , or right and each one has a 1/4 chance of occurring.

The function takes in the  number of steps that you want as an argument.

For example if you pass in 10, the random walker will take 10 steps and prints out the location every time and return the squared distance. 


---

<br>
<center><img src='/module7/m7_s18_02.png'  width = "90%" alt="404 image" /></center>

Notes: 

The `random()` function that we import in from the `random` library generates a float from 0 and 1. 


---

<br>
<center><img src='/module7/m7_s18_03.png'  width = "90%" alt="404 image" /></center>

Notes: 

The code works by checking if the number generated is between 0-0.25, 0.25-0.5  0.5-0.75 or 0.75-1 each internal pertaining to one of the directions left, right, up or down.

This means each direction has a 25% chance of happening but there is a bug in this code that we will soon discover. 


---

<br>
<center><img src='/module7/m7_s18_04.png'  width = "90%" alt="404 image" /></center>

Notes: 

We are going to run the cell `random_walker(20) which will print 20 steps. 

It’s hard to know immediately that something is wrong  but you can see that we’ve moved negatively in x directions (to the left) and positive in the y direction (to the right). 


---

<br>
<center><img src='/module7/m7_s18_05.png'  width = "90%" alt="404 image" /></center>

Notes: 

If we run it again we are going to get different out since it uses a random number generator `random()` but weirdly we see the same thing again. 

We seem to be consistently moving left and up.

When we run it over and over, we see these results repeating. 

Why do we keep moving to the left and up when this function is suppose to result in equal probability for any of the four choices. 

Something seems a little bit suspicious.

What is going on? 



---

<br>
<center><img src='/module7/m7_s18_07.png'  width = "90%" alt="404 image" /></center>

Notes: 

To get a little help in figuring this out we are going to do something called setting a `breakpoint()`.

`Breakpoint()` works by slowing down the executing process. Now when Python gets to this `breakpoint()` function (which is part of the Python debugger) the code will stop running.

We then can execute the code line by line and attempt to diagnose the problem. 

We run the  `random_walker()` function again to redefine it since we’ve added this `breakpoint()` function. Now when the random walker function is called, it’s going to stop executing at this breakpoint. 



---

<br>
<center><img src='/module7/m7_s18_08.png'  width = "90%" alt="404 image" /></center>

Notes: 

This is what is returned. 

We see this `pdb` which stands for python debugger. 

Our code has stopped and it shows the line Python is currently stopped on, in this case its `if rand < 0.25:`



---

<br>
<center><img src='/module7/m7_s18_09.png'  width = "90%" alt="404 image" /></center>

Notes: 

We can see what the random number was by typing `print(rand) and it tells us 0.957


---

<br>
<center><img src='/module7/m7_s18_10.png'  width = "90%" alt="404 image" /></center>

Notes: 

If we press `n`, it runs to the next line. 
We don't expect Python to go into the condition body since `rand` does not meet the condition. 



---

<br>
<center><img src='/module7/m7_s18_11.png'  width = "90%" alt="404 image" /></center>

Notes: 

We don't expect Python to go into the condition body since `rand` does not meet the condition. 



---

<br>
<center><img src='/module7/m7_s18_13.png'  width = "90%" alt="404 image" /></center>

Notes: 

The next 2 lines skip the statement bodies because they are not met as well. 


---

<br>
<center><img src='/module7/m7_s18_12.png'  width = "90%" alt="404 image" /></center>

Notes: 

We do however meet the else condition and so `y` is given a value of negative 1. 
Nothing seems terribly wrong yet.



---

<br>
<center><img src='/module7/m7_s18_14.png'  width = "90%" alt="404 image" /></center>

Notes: 

Pressing `n` again brings us back to the top of the `for` loop. 


---

<br>
<center><img src='/module7/m7_s18_15.png'  width = "90%" alt="404 image" /></center>

Notes: 

We reassign `rand` a new random value which turns our to be 0.0057.


---

<br>
<center><img src='/module7/m7_s18_16.png'  width = "90%" alt="404 image" /></center>

Notes: 

Let's go through  another round of these `if` with our new random value. 



---

<br>
<center><img src='/module7/m7_s18_17.png'  width = "90%" alt="404 image" /></center>

Notes: 

We do expect to go inside of this first `if` statement because the random number is actually less than a 0.25. Because our values is less than 0.25 we expect that in this step we are moving to the right where `x=+1`. 

We run this code and we moved to the right like we said we would. 



---

<br>
<center><img src='/module7/m7_s18_18.png'  width = "90%" alt="404 image" /></center>

Notes: 

We keep going and check the next condition and this is where things get suspicious. 

We move to the left ***and** to the right which is not the intention of the code. 



---

<br>
<center><img src='/module7/m7_s18_20.png'  width = "90%" alt="404 image" /></center>

Notes: 

The intention behind this code is that only one of these four directions would be taken. 
If the number was between zero and a quarter, the step would be to the right. If it was between a quarter and half the step would be to the left, between half and three quarters the steph would be up and between three quarters and one the step would be down. 

This way there is always an equal chance of each direction. 

When the random number was .005, it moved in 2 directions which doesn't make sense since only 1 step was supposed to be taken and here it’s moving to the left, to the right and upward. 


---

<br>
<center><img src='/module7/m7_s18_21.png'  width = "90%" alt="404 image" /></center>

Notes: 

The reason that this happens is because  the two inner if statements should be `elif` statements and not `if` statements. 
In other words if this is the case do this *but don't do anything else* or if this is the case do this *but don't do anything else*.

By accidentally having `if` statements instead of `elif` statements it was allowing the execution of multiple condition bodies.

Whenever a small number was generated, the movement would be left and right or just left but it would be impossible to move right without moving left.  

In general, the movement would always be left and up and not right. 


---

<br>
<center><img src='/module7/m7_s18_23.png'  width = "90%" alt="404 image" /></center>

Notes: 

So we’ve fixed the code and we're done with the debugger. We stepped through the code step by step which helped us solve the bug. We could try and do in our head but that can be really hard as code gets more complicated. This breakpoint is convenient because it allows us to actually see what's happening at each step. 


To get out of the debugger we write `q` for "quit". We can remove the `breakpoint()` function by deleting it or commenting it out temporarily and run our cell again with the fixed code. 


---

<br>
<center><img src='/module7/m7_s18_25.png'  width = "90%" alt="404 image" /></center>

Notes: 

It's really hard to test code that's random since we can't just look at the output and recognize that it’s been fixed but we can run it a few times and see that steps are being taken in different directions now and things seem a little more reasonable. 



The Python debugger has other function that can help debug your code and you can explore them in the <a href="https://docs.python.org/3/library/pdb.html" target="_blank">documentation</a>.


---

# Let’s apply what we learned!

Notes: <br>